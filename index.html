<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NutriTrack - Calorie Calculator</title>
    
    <!-- 1. Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- 2. Load React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- 3. Load Babel (to compile React in the browser) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- 4. Load Lucide Icons (Script version) -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        /* Custom scrollbar for cleanliness */
        .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: transparent;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background-color: #cbd5e1;
            border-radius: 20px;
        }
        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }
        .scrollbar-hide {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 font-sans selection:bg-emerald-100">

    <!-- App Root -->
    <div id="root"></div>

    <!-- React Application Logic -->
    <script type="text/babel">
        const { useState, useMemo, useEffect } = React;

        // --- ICONS COMPONENT ---
        // Since we are in a single file, we create simple SVG components for icons
        const Icon = ({ name, className }) => {
            const icons = {
                Search: <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>,
                Plus: <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M5 12h14"/><path d="M12 5v14"/></svg>,
                Trash2: <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/></svg>,
                ChefHat: <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M6 13.87A4 4 0 0 1 7.41 6a5.11 5.11 0 0 1 1.05-1.54 5 5 0 0 1 7.08 0A5.11 5.11 0 0 1 16.59 6 4 4 0 0 1 18 13.87V21H6Z"/><line x1="6" x2="18" y1="17" y2="17"/></svg>,
                Beef: <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12.5" cy="8.5" r="2.5"/><path d="M12.5 2a6.5 6.5 0 0 0-6.22 4.6c-1.1 3.13-.78 6.64 1.72 9.14a8 8 0 0 0 10.71.55c2.37-1.92 3.32-5.12 2.37-8.1a6.5 6.5 0 0 0-6.08-4.19Z"/></svg>,
                Wheat: <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M2 22 16 8"/><path d="M3.47 12.53 5 11l1.53 1.53a3.5 3.5 0 0 1 0 4.94L2 22l4.53-4.53a3.5 3.5 0 0 1 4.94 0L13 19l-1.53 1.53"/><path d="M7.47 8.53 9 7l1.53 1.53a3.5 3.5 0 0 1 0 4.94L6 18l4.53-4.53a3.5 3.5 0 0 1 4.94 0L17 15l-1.53 1.53"/><path d="M11.47 4.53 13 3l1.53 1.53a3.5 3.5 0 0 1 0 4.94L10 14l4.53-4.53a3.5 3.5 0 0 1 4.94 0L21 11l-1.53 1.53"/></svg>,
                Droplet: <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M12 22a7 7 0 0 0 7-7c0-2-1-3.9-3-5.5s-3.5-4-4-6.5c-.5 2.5-2 4.9-4 6.5C6 11.1 5 13 5 15a7 7 0 0 0 7 7z"/></svg>,
                Sprout: <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M7 20h10"/><path d="M10 20c5.5-2.5.8-6.4 3-10"/><path d="M9.5 9.4c1.1.8 1.8 2.2 2.3 3.7-2 .4-3.2.4-4.8-.4-1.2-.6-2.1-1.9-2.6-3.3C4.3 6.3 7.4 8 9.5 9.4z"/><path d="M14.1 6a7 7 0 0 0-1.1 4c1.9-.1 3.3-.6 4.3-1.4 1.7-1.3 2.9-3.8 3-6-2.3.5-5.2 1.9-6.2 3.4z"/></svg>,
                Utensils: <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2"/><path d="M7 2v20"/><path d="M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7"/></svg>,
                Target: <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></svg>,
                PieChart: <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M21.21 15.89A10 10 0 1 1 8 2.83"/><path d="M22 12A10 10 0 0 0 12 2v10z"/></svg>
            };
            return icons[name] || null;
        };


        // --- DATA: EXTENSIVE FOOD DATABASE (Calories per 100g) ---
        const FOOD_DATABASE = [
            // CARBOHYDRATES & GRAINS
            { id: 1, name: "White Rice (Cooked)", category: "Grains", cal: 130, pro: 2.7, carbs: 28, fat: 0.3, fiber: 0.4, icon: "ðŸš" },
            { id: 2, name: "Brown Rice (Cooked)", category: "Grains", cal: 111, pro: 2.6, carbs: 23, fat: 0.9, fiber: 1.8, icon: "ðŸŒ¾" },
            { id: 3, name: "Oats (Raw)", category: "Grains", cal: 389, pro: 16.9, carbs: 66, fat: 6.9, fiber: 10.6, icon: "ðŸ¥£" },
            { id: 4, name: "Whole Wheat Bread", category: "Grains", cal: 247, pro: 13, carbs: 41, fat: 3.4, fiber: 7.0, icon: "ðŸž" },
            { id: 5, name: "White Bread", category: "Grains", cal: 265, pro: 9, carbs: 49, fat: 3.2, fiber: 2.7, icon: "ðŸ¥ª" },
            { id: 6, name: "Pasta (Cooked)", category: "Grains", cal: 131, pro: 5, carbs: 25, fat: 1.1, fiber: 1.2, icon: "ðŸ" },
            { id: 100, name: "Chapathi / Roti", category: "Grains", cal: 297, pro: 10, carbs: 53, fat: 7, fiber: 9, icon: "ðŸ«“" },
            { id: 101, name: "Ragi Java (Porridge)", category: "Grains", cal: 120, pro: 3, carbs: 25, fat: 1, fiber: 3, icon: "ðŸ¥£" },
            
            // VEGETABLES
            { id: 7, name: "Potato (Boiled)", category: "Vegetables", cal: 87, pro: 1.9, carbs: 20, fat: 0.1, fiber: 2.2, icon: "ðŸ¥”" },
            { id: 8, name: "Sweet Potato", category: "Vegetables", cal: 86, pro: 1.6, carbs: 20, fat: 0.1, fiber: 3.0, icon: "ðŸ " },
            { id: 60, name: "Broccoli", category: "Vegetables", cal: 34, pro: 2.8, carbs: 7, fat: 0.4, fiber: 2.6, icon: "ðŸ¥¦" },
            { id: 61, name: "Carrot", category: "Vegetables", cal: 41, pro: 0.9, carbs: 10, fat: 0.2, fiber: 2.8, icon: "ðŸ¥•" },
            { id: 62, name: "Spinach", category: "Vegetables", cal: 23, pro: 2.9, carbs: 3.6, fat: 0.4, fiber: 2.2, icon: "ðŸƒ" },
            { id: 63, name: "Cucumber", category: "Vegetables", cal: 15, pro: 0.7, carbs: 3.6, fat: 0.1, fiber: 0.5, icon: "ðŸ¥’" },
            { id: 102, name: "Beetroot", category: "Vegetables", cal: 43, pro: 1.6, carbs: 10, fat: 0.2, fiber: 2.8, icon: "ðŸŸ£" },

            // PROTEINS (MEAT, LEGUMES & ALTERNATIVES)
            { id: 20, name: "Chicken Breast (Cooked)", category: "Protein", cal: 165, pro: 31, carbs: 0, fat: 3.6, fiber: 0, icon: "ðŸ—" },
            { id: 21, name: "Chicken Thigh (Cooked)", category: "Protein", cal: 209, pro: 26, carbs: 0, fat: 10.9, fiber: 0, icon: "ðŸ–" },
            { id: 103, name: "Chicken (With Bone, Curry)", category: "Protein", cal: 230, pro: 22, carbs: 2, fat: 14, fiber: 0, icon: "ðŸ¥˜" },
            { id: 22, name: "Egg (Whole, Boiled)", category: "Protein", cal: 155, pro: 13, carbs: 1.1, fat: 11, fiber: 0, icon: "ðŸ¥š" },
            { id: 104, name: "Egg Omelette", category: "Protein", cal: 154, pro: 11, carbs: 0.6, fat: 12, fiber: 0, icon: "ðŸ³" },
            { id: 23, name: "Egg White", category: "Protein", cal: 52, pro: 11, carbs: 0.7, fat: 0.2, fiber: 0, icon: "âšª" },
            { id: 24, name: "Salmon (Cooked)", category: "Protein", cal: 208, pro: 20, carbs: 0, fat: 13, fiber: 0, icon: "ðŸŸ" },
            { id: 25, name: "Tuna (Canned in Water)", category: "Protein", cal: 116, pro: 26, carbs: 0, fat: 1, fiber: 0, icon: "ðŸ¥«" },
            { id: 26, name: "Tofu", category: "Protein", cal: 76, pro: 8, carbs: 1.9, fat: 4.8, fiber: 0.3, icon: "ðŸ§Š" },
            { id: 27, name: "Lentils (Dal, Cooked)", category: "Protein", cal: 116, pro: 9, carbs: 20, fat: 0.4, fiber: 7.9, icon: "ðŸ²" },
            { id: 105, name: "Soya Chunks", category: "Protein", cal: 345, pro: 52, carbs: 33, fat: 0.5, fiber: 13, icon: "ðŸŸ¤" },
            { id: 106, name: "Mung Bean (Green Gram, Cooked)", category: "Protein", cal: 105, pro: 7, carbs: 19, fat: 0.4, fiber: 7.6, icon: "ðŸŒ±" },
            { id: 107, name: "Rajma (Kidney Beans, Cooked)", category: "Protein", cal: 127, pro: 9, carbs: 23, fat: 0.5, fiber: 6.4, icon: "ðŸ«˜" },
            { id: 108, name: "Chana (Chickpeas, Cooked)", category: "Protein", cal: 164, pro: 9, carbs: 27, fat: 2.6, fiber: 7.6, icon: "ðŸ¥™" },
            
            // FRUITS
            { id: 40, name: "Banana", category: "Fruits", cal: 89, pro: 1.1, carbs: 23, fat: 0.3, fiber: 2.6, icon: "ðŸŒ" },
            { id: 41, name: "Apple", category: "Fruits", cal: 52, pro: 0.3, carbs: 14, fat: 0.2, fiber: 2.4, icon: "ðŸŽ" },
            { id: 42, name: "Orange", category: "Fruits", cal: 47, pro: 0.9, carbs: 12, fat: 0.1, fiber: 2.4, icon: "ðŸŠ" },
            { id: 43, name: "Grapes", category: "Fruits", cal: 69, pro: 0.7, carbs: 18, fat: 0.2, fiber: 0.9, icon: "ðŸ‡" },
            { id: 44, name: "Strawberries", category: "Fruits", cal: 32, pro: 0.7, carbs: 7.7, fat: 0.3, fiber: 2.0, icon: "ðŸ“" },
            { id: 45, name: "Mango", category: "Fruits", cal: 60, pro: 0.8, carbs: 15, fat: 0.4, fiber: 1.6, icon: "ðŸ¥­" },
            { id: 46, name: "Watermelon", category: "Fruits", cal: 30, pro: 0.6, carbs: 8, fat: 0.2, fiber: 0.4, icon: "ðŸ‰" },
            { id: 109, name: "Guava", category: "Fruits", cal: 68, pro: 2.6, carbs: 14, fat: 0.9, fiber: 5.4, icon: "ðŸˆ" },

            // DAIRY & FATS
            { id: 80, name: "Milk (Whole)", category: "Dairy", cal: 61, pro: 3.2, carbs: 4.8, fat: 3.3, fiber: 0, icon: "ðŸ¥›" },
            { id: 81, name: "Greek Yogurt", category: "Dairy", cal: 59, pro: 10, carbs: 3.6, fat: 0.4, fiber: 0, icon: "ðŸ¥£" },
            { id: 82, name: "Cheddar Cheese", category: "Dairy", cal: 402, pro: 25, carbs: 1.3, fat: 33, fiber: 0, icon: "ðŸ§€" },
            { id: 110, name: "Paneer (Cottage Cheese)", category: "Dairy", cal: 265, pro: 18, carbs: 1.2, fat: 20, fiber: 0, icon: "ðŸ§ˆ" },
            { id: 83, name: "Butter", category: "Dairy", cal: 717, pro: 0.9, carbs: 0.1, fat: 81, fiber: 0, icon: "ðŸ§ˆ" },
            { id: 111, name: "Ghee (Clarified Butter)", category: "Dairy", cal: 900, pro: 0, carbs: 0, fat: 100, fiber: 0, icon: "ðŸ¯" },
            
            // SNACKS & DRY FRUITS
            { id: 85, name: "Almonds", category: "Snacks", cal: 579, pro: 21, carbs: 22, fat: 50, fiber: 12.5, icon: "ðŸŒ°" },
            { id: 84, name: "Peanut Butter", category: "Snacks", cal: 588, pro: 25, carbs: 20, fat: 50, fiber: 6, icon: "ðŸ¥œ" },
            { id: 112, name: "Cashews", category: "Snacks", cal: 553, pro: 18, carbs: 30, fat: 44, fiber: 3.3, icon: "ðŸ¥œ" },
            { id: 113, name: "Walnuts", category: "Snacks", cal: 654, pro: 15, carbs: 14, fat: 65, fiber: 6.7, icon: "ðŸ§ " },
            { id: 114, name: "Raisins", category: "Snacks", cal: 299, pro: 3, carbs: 79, fat: 0.5, fiber: 3.7, icon: "ðŸ‡" },
            { id: 115, name: "Dates", category: "Snacks", cal: 282, pro: 2.5, carbs: 75, fat: 0.4, fiber: 8, icon: "ðŸŒ´" },
            { id: 116, name: "Dry Fruit Laddoo", category: "Snacks", cal: 480, pro: 10, carbs: 55, fat: 28, fiber: 6, icon: "ðŸ¡" },
            { id: 117, name: "Potato Chips (Lays Packet)", category: "Snacks", cal: 536, pro: 7, carbs: 53, fat: 35, fiber: 4, icon: "ðŸ¥¡" },
        ];

        const CATEGORIES = ["All", "Grains", "Protein", "Fruits", "Vegetables", "Dairy", "Snacks"];

        function CalorieCalculator() {
            const [searchQuery, setSearchQuery] = useState("");
            const [selectedCategory, setSelectedCategory] = useState("All");
            const [dailyLog, setDailyLog] = useState([]);
            const [calorieGoal, setCalorieGoal] = useState(2200);
            const [editingGoal, setEditingGoal] = useState(false);

            // --- DERIVED STATE ---
            const filteredFood = useMemo(() => {
                return FOOD_DATABASE.filter(item => {
                    const matchesSearch = item.name.toLowerCase().includes(searchQuery.toLowerCase());
                    const matchesCategory = selectedCategory === "All" || item.category === selectedCategory;
                    return matchesSearch && matchesCategory;
                });
            }, [searchQuery, selectedCategory]);

            const totals = useMemo(() => {
                return dailyLog.reduce((acc, item) => ({
                    cal: acc.cal + item.calculatedCal,
                    pro: acc.pro + item.calculatedPro,
                    carbs: acc.carbs + item.calculatedCarbs,
                    fat: acc.fat + item.calculatedFat,
                    fiber: acc.fiber + item.calculatedFiber
                }), { cal: 0, pro: 0, carbs: 0, fat: 0, fiber: 0 });
            }, [dailyLog]);

            const progressPercentage = Math.min((totals.cal / calorieGoal) * 100, 100);

            // --- ACTIONS ---
            const addToLog = (item, weight) => {
                if (!weight || weight <= 0) return;
                
                const factor = weight / 100;
                const newItem = {
                    ...item,
                    logId: Date.now(),
                    weight: parseFloat(weight),
                    calculatedCal: Math.round(item.cal * factor),
                    calculatedPro: Math.round(item.pro * factor),
                    calculatedCarbs: Math.round(item.carbs * factor),
                    calculatedFat: Math.round(item.fat * factor),
                    calculatedFiber: Math.round(item.fiber * factor * 10) / 10,
                };

                setDailyLog(prev => [newItem, ...prev]);
            };

            const removeFromLog = (logId) => {
                setDailyLog(prev => prev.filter(item => item.logId !== logId));
            };

            return (
                <div className="min-h-screen bg-slate-50 text-slate-800 font-sans selection:bg-emerald-100">
                    
                    {/* HEADER */}
                    <header className="bg-white shadow-sm border-b border-slate-200 sticky top-0 z-30">
                        <div className="max-w-7xl mx-auto px-4 py-4 flex items-center justify-between">
                            <div className="flex items-center gap-2">
                                <div className="w-10 h-10 bg-emerald-500 rounded-xl flex items-center justify-center shadow-emerald-200 shadow-lg">
                                    <Icon name="ChefHat" className="text-white w-6 h-6" />
                                </div>
                                <div>
                                    <h1 className="text-xl font-bold text-slate-900 tracking-tight">NutriTrack</h1>
                                    <p className="text-xs text-slate-500 font-medium">Daily Calorie Counter</p>
                                </div>
                            </div>
                            
                            <div className="hidden sm:flex items-center gap-6 text-sm font-medium text-slate-600">
                                <div className="flex items-center gap-1.5">
                                    <Icon name="Beef" className="w-4 h-4 text-rose-500" />
                                    <span>Protein</span>
                                </div>
                                <div className="flex items-center gap-1.5">
                                    <Icon name="Wheat" className="w-4 h-4 text-amber-500" />
                                    <span>Carbs</span>
                                </div>
                                <div className="flex items-center gap-1.5">
                                    <Icon name="Droplet" className="w-4 h-4 text-yellow-500" />
                                    <span>Fats</span>
                                </div>
                                <div className="flex items-center gap-1.5">
                                    <Icon name="Sprout" className="w-4 h-4 text-emerald-500" />
                                    <span>Fiber</span>
                                </div>
                            </div>
                        </div>
                    </header>

                    <main className="max-w-7xl mx-auto px-4 py-8 grid grid-cols-1 lg:grid-cols-12 gap-8">
                        
                        {/* LEFT COLUMN: FOOD SELECTION (7 cols) */}
                        <div className="lg:col-span-7 space-y-6">
                            
                            {/* SEARCH & FILTER */}
                            <div className="bg-white p-4 rounded-2xl shadow-sm border border-slate-200">
                                <div className="relative mb-4">
                                    <span className="absolute left-3 top-3.5 text-slate-400">
                                        <Icon name="Search" className="w-5 h-5" />
                                    </span>
                                    <input 
                                        type="text" 
                                        placeholder="Search food (e.g., Rice, Chicken, Apple)..." 
                                        className="w-full pl-10 pr-4 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 outline-none transition-all placeholder:text-slate-400"
                                        value={searchQuery}
                                        onChange={(e) => setSearchQuery(e.target.value)}
                                    />
                                </div>
                                
                                <div className="flex gap-2 overflow-x-auto pb-2 scrollbar-hide">
                                    {CATEGORIES.map(cat => (
                                        <button
                                            key={cat}
                                            onClick={() => setSelectedCategory(cat)}
                                            className={`px-4 py-1.5 rounded-full text-sm font-medium whitespace-nowrap transition-colors ${
                                                selectedCategory === cat 
                                                    ? "bg-emerald-600 text-white shadow-md shadow-emerald-200" 
                                                    : "bg-slate-100 text-slate-600 hover:bg-slate-200"
                                            }`}
                                        >
                                            {cat}
                                        </button>
                                    ))}
                                </div>
                            </div>

                            {/* FOOD GRID */}
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                {filteredFood.length > 0 ? (
                                    filteredFood.map(item => (
                                        <FoodCard key={item.id} item={item} onAdd={addToLog} />
                                    ))
                                ) : (
                                    <div className="col-span-full py-12 text-center text-slate-400">
                                        <p>No food items found matching "{searchQuery}"</p>
                                    </div>
                                )}
                            </div>
                        </div>

                        {/* RIGHT COLUMN: DASHBOARD & LOG (5 cols) */}
                        <div className="lg:col-span-5 space-y-6">
                            
                            {/* DASHBOARD CARD */}
                            <div className="bg-slate-900 text-white p-6 rounded-3xl shadow-xl shadow-slate-200 relative overflow-hidden">
                                {/* Background Decorations */}
                                <div className="absolute top-0 right-0 w-32 h-32 bg-emerald-500 rounded-full blur-3xl opacity-20 -mr-10 -mt-10 pointer-events-none"></div>
                                
                                <div className="relative z-10">
                                    <div className="flex justify-between items-start mb-6">
                                        <div>
                                            <h2 className="text-2xl font-bold">Today's Summary</h2>
                                            <div className="flex items-center gap-2 text-slate-400 text-sm cursor-pointer" onClick={() => setEditingGoal(!editingGoal)}>
                                                <Icon name="Target" className="w-4 h-4" />
                                                {editingGoal ? (
                                                    <input 
                                                        type="number" 
                                                        autoFocus
                                                        className="w-16 bg-slate-800 border border-slate-600 rounded px-1 text-white text-xs"
                                                        value={calorieGoal}
                                                        onChange={(e) => setCalorieGoal(Number(e.target.value))}
                                                        onBlur={() => setEditingGoal(false)}
                                                    />
                                                ) : (
                                                    <span>Goal: {calorieGoal} kcal</span>
                                                )}
                                            </div>
                                        </div>
                                        <div className="text-right">
                                            <span className="text-4xl font-bold tracking-tighter text-emerald-400">{totals.cal}</span>
                                            <span className="text-sm text-slate-400 block">kcal consumed</span>
                                        </div>
                                    </div>

                                    {/* Progress Bar */}
                                    <div className="w-full bg-slate-800 rounded-full h-3 mb-6 overflow-hidden">
                                        <div 
                                            className={`h-full rounded-full transition-all duration-500 ease-out ${
                                                progressPercentage > 100 ? 'bg-rose-500' : 'bg-emerald-500'
                                            }`}
                                            style={{ width: `${progressPercentage}%` }}
                                        ></div>
                                    </div>

                                    {/* Macro Grid */}
                                    <div className="grid grid-cols-2 sm:grid-cols-4 gap-4">
                                        <MacroStat label="Protein" value={totals.pro} color="text-rose-400" />
                                        <MacroStat label="Carbs" value={totals.carbs} color="text-amber-400" />
                                        <MacroStat label="Fat" value={totals.fat} color="text-yellow-400" />
                                        <MacroStat label="Fiber" value={totals.fiber.toFixed(1)} color="text-emerald-400" />
                                    </div>
                                </div>
                            </div>

                            {/* DAILY LOG */}
                            <div className="bg-white rounded-2xl shadow-sm border border-slate-200 flex flex-col h-[600px]">
                                <div className="p-4 border-b border-slate-100 flex justify-between items-center bg-slate-50/50 rounded-t-2xl">
                                    <h3 className="font-semibold text-slate-800 flex items-center gap-2">
                                        <Icon name="Utensils" className="w-4 h-4 text-emerald-600" />
                                        Food Log
                                    </h3>
                                    <span className="text-xs font-medium bg-emerald-100 text-emerald-700 px-2 py-1 rounded-full">
                                        {dailyLog.length} Items
                                    </span>
                                </div>
                                
                                <div className="flex-1 overflow-y-auto p-2 space-y-1 custom-scrollbar">
                                    {dailyLog.length === 0 ? (
                                        <div className="h-full flex flex-col items-center justify-center text-slate-400 space-y-4">
                                            <div className="w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center">
                                                <Icon name="PieChart" className="w-8 h-8 text-slate-300" />
                                            </div>
                                            <p className="text-sm">Your log is empty. Add some food!</p>
                                        </div>
                                    ) : (
                                        dailyLog.map((item) => (
                                            <div key={item.logId} className="group flex items-center justify-between p-3 hover:bg-slate-50 rounded-xl transition-colors border border-transparent hover:border-slate-100">
                                                <div className="flex items-center gap-3">
                                                    <span className="text-2xl">{item.icon}</span>
                                                    <div>
                                                        <p className="font-medium text-slate-700 leading-tight">{item.name}</p>
                                                        <p className="text-xs text-slate-500">{item.weight}g â€¢ <span className="text-emerald-600 font-medium">{item.calculatedCal} kcal</span> â€¢ <span className="text-slate-400">Fib: {item.calculatedFiber}g</span></p>
                                                    </div>
                                                </div>
                                                <button 
                                                    onClick={() => removeFromLog(item.logId)}
                                                    className="p-2 text-slate-300 hover:text-rose-500 hover:bg-rose-50 rounded-lg transition-all opacity-0 group-hover:opacity-100"
                                                >
                                                    <Icon name="Trash2" className="w-4 h-4" />
                                                </button>
                                            </div>
                                        ))
                                    )}
                                </div>
                                
                                {/* Footer Summary in Log */}
                                <div className="p-4 bg-slate-50 rounded-b-2xl border-t border-slate-100 text-xs text-slate-500 flex justify-between">
                                    <span>Total Protein: {totals.pro}g</span>
                                    <span>Total Fiber: {totals.fiber.toFixed(1)}g</span>
                                </div>
                            </div>

                        </div>
                    </main>
                </div>
            );
        }

        // --- SUB-COMPONENTS ---

        function FoodCard({ item, onAdd }) {
            const [weight, setWeight] = useState(100);

            const handleAdd = () => {
                onAdd(item, weight);
                setWeight(100); // Reset after adding
            };

            return (
                <div className="bg-white p-4 rounded-2xl border border-slate-200 hover:shadow-lg hover:border-emerald-200 transition-all duration-300 group">
                    <div className="flex justify-between items-start mb-3">
                        <div className="flex gap-3">
                            <div className="w-10 h-10 bg-slate-50 rounded-lg flex items-center justify-center text-2xl group-hover:scale-110 transition-transform">
                                {item.icon}
                            </div>
                            <div>
                                <h3 className="font-bold text-slate-800">{item.name}</h3>
                                <p className="text-xs text-slate-500 bg-slate-100 inline-block px-1.5 py-0.5 rounded mt-1">{item.category}</p>
                            </div>
                        </div>
                        <div className="text-right">
                            <span className="text-sm font-bold text-emerald-600">{Math.round((weight/100) * item.cal)}</span>
                            <span className="text-xs text-slate-400 block">kcal</span>
                        </div>
                    </div>

                    {/* Macros Row */}
                    <div className="flex gap-2 mb-4 text-[10px] font-medium text-slate-500 uppercase tracking-wide flex-wrap">
                        <span className="bg-rose-50 text-rose-600 px-1.5 py-0.5 rounded">P: {((weight/100)*item.pro).toFixed(1)}</span>
                        <span className="bg-amber-50 text-amber-600 px-1.5 py-0.5 rounded">C: {((weight/100)*item.carbs).toFixed(1)}</span>
                        <span className="bg-yellow-50 text-yellow-600 px-1.5 py-0.5 rounded">F: {((weight/100)*item.fat).toFixed(1)}</span>
                        <span className="bg-emerald-50 text-emerald-600 px-1.5 py-0.5 rounded">Fib: {((weight/100)*item.fiber).toFixed(1)}</span>
                    </div>

                    {/* Input Area */}
                    <div className="flex items-center gap-2">
                        <div className="relative flex-1">
                            <input 
                                type="number" 
                                min="1"
                                className="w-full bg-slate-50 border border-slate-200 rounded-lg py-1.5 px-2 text-sm focus:ring-1 focus:ring-emerald-500 outline-none"
                                value={weight}
                                onChange={(e) => setWeight(Number(e.target.value))}
                            />
                            <span className="absolute right-2 top-1.5 text-xs text-slate-400 font-medium pointer-events-none">g</span>
                        </div>
                        <button 
                            onClick={handleAdd}
                            className="bg-slate-900 hover:bg-emerald-600 text-white p-1.5 rounded-lg transition-colors flex items-center justify-center"
                        >
                            <Icon name="Plus" className="w-5 h-5" />
                        </button>
                    </div>
                </div>
            );
        }

        function MacroStat({ label, value, color }) {
            return (
                <div className="bg-slate-800/50 rounded-xl p-3 backdrop-blur-sm">
                    <p className="text-xs text-slate-400 mb-1">{label}</p>
                    <p className={`text-xl font-bold ${color}`}>{value}<span className="text-xs text-slate-500 ml-0.5 font-normal">g</span></p>
                </div>
            );
        }

        // Render the app
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<CalorieCalculator />);
    </script>
</body>
</html>
